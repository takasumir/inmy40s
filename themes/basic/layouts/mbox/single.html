{{ define "head" }}
  {{ $apiKey := getenv "HUGO_MBOX_API_KEY" }}
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.10.0/mapbox-gl.js"></script>
  <link
    href="https://api.mapbox.com/mapbox-gl-js/v3.10.0/mapbox-gl.css"
    rel="stylesheet"
  />
  {{- with resources.Get "js/mbox.ts" }}
    {{- if eq hugo.Environment "development" }}
      {{- $opts := dict "params" (dict "apiKey" $apiKey) }}
      {{- with . | js.Build $opts }}
        <script defer src="{{ .RelPermalink }}"></script>
      {{- end }}
    {{- else }}
      {{- $opts := dict "minify" true "params" (dict "apiKey" $apiKey) }}
      {{- with . | js.Build $opts | fingerprint }}
        <script
          defer
          src="{{ .RelPermalink }}"
          integrity="{{- .Data.Integrity }}"
          crossorigin="anonymous"
        ></script>
      {{- end }}
    {{- end }}
  {{- end }}
{{ end }}
{{ define "main" }}
  <article class="sm:p-2">
    {{ partial "single-post-header.html" . }}
    <div class="markdown my-2">
      {{ .Content }}
    </div>
    {{ partial "terms.html" (dict "taxonomy" "tags" "page" .) }}
  </article>
{{ end }}
